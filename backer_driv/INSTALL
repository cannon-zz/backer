                           INSTALLATION INSTRUCTIONS
                           =========================


HARDWARE
--------

You have probably had your Backer working under Windows in which case you
already have it installed and know there are no hardware conflicts.  If you
are installing the hardware for the first time then you should first check
to see which I/O ports and DMA channels are being used by taking a look at
the two files /proc/ioports and /proc/dma.  Set your Backer to a free I/O
port and DMA channel then just follow the installation instructions that
came with the card.



SOFTWARE
--------

Here are the steps for installing the driver.

1.  Configure the driver parameters for your system.  The constants that
should be set are:

	In Makefile

	BKR_MAJOR
	MODULES_DIR
	PREFIX

	In backer_isa.c

	CONFIG_BACKER_IOPORT
	CONFIG_BACKER_DMA
	CONFIG_BACKER_TIMEOUT

In the Makefile, BKR_MAJOR is the major number the device inodes will have.
You can set this to anything your system isn't using.  It currently
defaults to 60 which is in one of the blocks of numbers set aside for
``experimental and local use''.  You only need to change it if you already
have something using 60.

MODULES_DIR is the directory the compiled driver will be placed in.  The
default is /lib/modules/misc.

PREFIX is the top of the hierarchy in which the manual page will be placed.
The man page is put in PREFIX/man/man4.

The parameters in backer_isa.c specify the hardware settings and the
timeout.  These can all be set at module load time although you might as
well configure them now in order to simplify things later.

The timeout does not need to be adjusted unless you want to tweak the
driver's behaviour to your own tastes.  It is the length of time the driver
will wait for an operation to finish before deciding something's wrong and
aborting.  It should not be less than the length of the BOR mark or the
driver will timeout while waiting for data to start during playback.  It
also must not be less than the time required to empty the DMA buffer or the
driver will timeout while flushing its buffers at the end of a recording.


2.  Compile the driver by typing

	make


3.  Install the driver, device inodes and man page by typing

	make install

This puts the driver into MODULES_DIR and runs depmod -a to rebuild the
module dependancy database.  Then it checks to see if devfs is in use and
if not it creates the device inodes in /dev.  Finally it installs the man
page.

If devfs is not being used but the install script can't determine that fact
then you will have to manually instruct make to create the device inodes by
typing

	make devs


4.  OPTIONAL.  Create /dev/tape link.  The driver is designed to imitate a
standard magnetic tape drive and if you want to use your Backer as your
default tape device you should create a symbolic link called /dev/tape that
points to your preferred device.  If you don't have devfs then you'll do
this by typing something like (using nhs as an example)

	ln -s backer/0/nhs /dev/tape

which would select high density NTSC in SP mode as the default tape format.

If you are using the device filesystem then you will have to create this
link every time the system reboots.  This can be taken care of for you if
you are running devfsd.  To configure devfsd to automatically create and
remove the /dev/tape link as the driver is loaded and unloaded, add
something like the following lines to your /etc/devfsd.conf

	REGISTER	backer	EXECUTE	ln -s backer/0/nhs /dev/tape
	UNREGISTER	backer	EXECUTE rm -f /dev/tape

and then tell devfsd to re-read its config file by doing

	killall -HUP devfsd


5.  OPTIONAL.  To let your system take care of automatically loading and
unloading the driver add the following lines to /etc/modules.conf

	alias /dev/backer backer
	alias /dev/tape backer
	options backer <options>

where the second line should, obviously, only be added if /dev/tape is a
link to a backer device and the last line is only needed if you need to
specify options (like the I/O port).  See below for available options.
Re-read the config file by doing

	depmod -a



LOADING/UNLOADING THE DRIVER
----------------------------

To load the driver manually, login as root and type

	insmod backer [options]

where the following options can be set:

	ioport=num
		Set the I/O port to num.
	dma=num
		Set the DMA channel to num.
	timeout=num
		Set the timeout to num seconds.

Here's an example load command:

	insmod backer ioport=0x304 dma=3 timeout=20

You'll get an error message if the driver couldn't be loaded.  If that
happens, check /var/log/messages to see what the problem was.  The driver
will have printed a little banner and will have complained if it couldn't
reserve a particular resource.  Note that to allow the DMA channel to be
shared, the driver will only request access to it when the device is
actually in use so successfully loading the driver does not guarantee that
there are no resource conflicts.

To test the driver just type

	cat /dev/zero > /dev/tape

to verify that data is being written to video.  On your television set you
should see some vertical bars for a few seconds (the BOR mark) followed by
something that looks like noise.  Press CTRL-C to stop the test.

To unload the module type

	rmmod backer
